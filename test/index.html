<!DOCTYPE html><html lang="zh-Hans"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="x5-fullscreen" content="true"><meta name="full-screen" content="yes"><meta name="theme-color" content="#317EFB"><meta content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=0" name="viewport"><meta name="description" content="前端自动化测试，前端测试框架JEST"><meta property="og:type" content="article"><meta property="og:title" content="前端自动化测试 【JEST】"><meta property="og:url" content="https://www.yangchenyu.com/test/index.html"><meta property="og:site_name"><meta property="og:description" content="前端自动化测试，前端测试框架JEST"><meta property="og:locale"><meta property="article:published_time" content="2020-12-16T06:36:51.000Z"><meta property="article:modified_time" content="2023-06-09T08:25:14.008Z"><meta property="article:author" content="Cheny"><meta property="article:tag" content="自动化测试"><meta name="twitter:card" content="summary"><meta name="keywords" content="前端前端自动化测试、JEST、单元测试"><title>前端自动化测试 【JEST】</title><link href="/favicon-16x16.png?v=1.2.14" rel="icon" type="image/png" sizes="16x16"><link href="/favicon-32x32.png?v=1.2.14" rel="icon" type="image/png" sizes="32x32"><link href="/apple-touch-icon.png?v=1.2.14" rel="apple-touch-icon" sizes="180x180"><link href="/site.webmanifest" rel="manifest"><link rel="stylesheet" href="/css/plugins/bootstrap.row.css"><link rel="stylesheet" href="https://unpkg.com/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css"><link rel="stylesheet" href="/css/plugins/font-awesome.min.css"><script>window.ASYNC_CONFIG={hostname:"www.yangchenyu.com",author:"Cheny",root:"/",typed_text:["Aspirant Developer"],favicon:{logo:"https://cheny-chenyu.oss-cn-chengdu.aliyuncs.com/img/blog-logo.png",icon16:"favicon-16x16.png",icon32:"favicon-32x32.png",appleTouchIcon:"apple-touch-icon.png",webmanifest:"/site.webmanifest",visibilitychange:!1,hidden:"/failure.ico",showText:"(/≧▽≦/)咦！又好了！",hideText:"(●—●)喔哟，崩溃啦！"},theme_version:"1.2.14",theme:{switch:!0,default:"auto"},search:{enable:!0,type:"local",href:"https://www.google.com/search?q=site:",domain:null,preload:!0,trigger:"auto",path:"search.xml"},i18n:{placeholder:"搜索...",empty:"找不到您查询的内容: ${query}",hits:"找到 ${hits} 条结果",hits_time:"找到 ${hits} 条结果（用时 ${time} 毫秒）",author:"本文作者：",copyright_link:"本文链接：",copyright_license_title:"版权声明：",copyright_license_content:"本博客所有文章除特别声明外，均默认采用 undefined 许可协议。",copy_button:"复制",copy_success:"复制成功",copy_failure:"复制失败",open_read_mode:"进入阅读模式",exit_read_mode:"退出阅读模式"},creative_commons:{license:"by-nc-sa",language:"deed.zh",post:!0,clipboard:!1},swup:!0,plugin:{flickr_justified_gallery:{js:"https://unpkg.com/flickr-justified-gallery@latest/dist/fjGallery.min.js"},fancybox:{css:"https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css",js:"https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"}},icons:{sun:"far fa-sun",moon:"far fa-moon",play:"fas fa-play",email:"far fa-envelope",next:"fas fa-arrow-right",calendar:"far fa-calendar-alt",clock:"far fa-clock",user:"far fa-user",back_top:"fas fa-arrow-up",close:"fas fa-times",search:"fas fa-search",reward:"fas fa-hand-holding-usd",user_tag:"fas fa-user-alt",toc_tag:"fas fa-th-list",read:"fas fa-book-reader",arrows:"fas fa-arrows-alt-h"}}</script><link data-swup-theme rel="stylesheet" href="/css/index.css?v=1.2.14" id="trm-switch-style"><script>let defaultMode="auto"!==ASYNC_CONFIG.theme.default?ASYNC_CONFIG.theme.default:window.matchMedia("(prefers-color-scheme: light)").matches?"style-light":"style-dark",catchMode=localStorage.getItem("theme-mode")||defaultMode,type="style-dark"===catchMode?"add":"remove";document.documentElement.classList[type]("dark")</script><script defer>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?bbad9d8e1fd8e044d365c2ce0d114c73";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="null" type="application/atom+xml"></head><body><div class="trm-app-frame"><div class="trm-preloader"><div class="trm-holder"><div class="preloader"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></div><div class="trm-mode-swich-animation-frame"><div class="trm-mode-swich-animation"><i class="i-sun"><i class="iconfont far fa-sun"></i></i><div class="trm-horizon"></div><i class="i-moon"><i class="iconfont far fa-moon"></i></i></div></div><div id="trm-dynamic-content" class="trm-swup-animation"><div id="trm-scroll-container" class="trm-scroll-container" data-scroll-container style="opacity:0"><div data-scroll-section id="content" class="trm-scroll-section"><div class="locomotive-scroll__sticky-target" style="position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none"></div><header class="trm-top-bar" data-scroll data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="-10"><div class="container"><div class="trm-left-side"><a href="/" class="trm-logo-frame trm-anima-link"><img alt="logo" src="https://cheny-chenyu.oss-cn-chengdu.aliyuncs.com/img/blog-logo.png"></a></div><div class="trm-right-side"><div class="trm-menu"><nav><ul><li class="menu-item-has-children"><a href="/" target="">Home</a></li><li class="menu-item-has-children"><a href="/archives/" target="">Archives</a></li><li class="menu-item-has-children"><a href="/links/" target="">Links</a></li><li class="menu-item-has-children"><a href="/about/" target="">About</a><ul><li><a href="/projects/" target="">Projects</a></li><li><a data-no-swup href="https://foreverblog.cn/go.html" target="_blank">Forever Go</a></li></ul></li></ul></nav></div><div class="trm-mode-switcher-place"><div class="trm-mode-switcher"><i class="iconfont far fa-sun"></i> <input class="tgl tgl-light" id="trm-swich" type="checkbox"> <label class="trm-swich" for="trm-swich"></label> <i class="iconfont far fa-moon"></i></div></div><div id="trm-search-btn" class="trm-search-btn"><i class="iconfont fas fa-search"></i></div></div><div class="trm-menu-btn"><span></span></div></div></header><div class="trm-content-start"><div class="trm-banner" data-scroll data-scroll-direction="vertical"><img style="object-position:top;object-fit:cover" alt="banner" class="trm-banner-cover" data-scroll data-scroll-direction="vertical" data-scroll-speed="-3" src="/img/banner.png"><div class="trm-banner-content trm-overlay"><div class="container" data-scroll data-scroll-direction="vertical" data-scroll-speed="0"><div class="row"><div class="col-lg-4"></div><div class="col-lg-8"><div class="trm-banner-text"><div class="trm-label trm-mb-20">NEWS LETTER</div><h1 class="trm-mb-30 trm-hsmb-font">前端自动化测试 【JEST】</h1><ul class="trm-breadcrumbs trm-label"><li><a href="/" class="trm-anima-link">Home</a></li><li><span>test</span></li></ul></div><a href="#about-triger" data-scroll-to="#about-triger" data-scroll-offset="-130" class="trm-scroll-hint-frame"><div class="trm-scroll-hint"></div><span class="trm-label">Scroll down</span></a></div></div></div></div></div><div class="container"><div class="row"><div id="page-sidebar" class="col-lg-4 hidden-sm"><div class="trm-main-card-frame trm-sidebar"><div class="trm-main-card" data-scroll data-scroll-repeat data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="60"><div class="trm-user-tabs" id="sidebar-tabs"><div class="trm-tabs-nav trm-mb-40" id="trm-tabs-nav"><div data-to="tabs-user" class="trm-tabs-nav-item"><i class="iconfont fas fa-user-alt"></i></div><div data-to="tabs-toc" class="trm-tabs-nav-item active"><i class="iconfont fas fa-th-list"></i></div></div><div name="tabs-user" class="trm-tabs-item"><div class="trm-mc-header"><div class="trm-avatar-frame trm-mb-20"><img alt="Avatar" class="trm-avatar" src="https://cheny-chenyu.oss-cn-chengdu.aliyuncs.com/img/ip.jpg"></div><h5 class="trm-name trm-mb-15">CHENY</h5><div class="trm-label">I`m <span class="trm-typed-text"></span></div></div><div class="trm-divider trm-mb-40 trm-mt-40"></div><div class="trm-social"><a href="https://github.com/ChenyCHENYU" title="Github" rel="nofollow" target="_blank"><i class="iconfont fab fa-github"></i> </a><a href="https://gitee.com/ycyplus163" title="Gitee" rel="nofollow" target="_blank"><i class="iconfont fab fa-github-alt"></i> </a><a href="https://www.tzagileteam.com/" title="AgileTeam" rel="nofollow" target="_blank"><i class="iconfont fas fa-blog"></i></a></div><div class="trm-divider trm-mb-40 trm-mt-40"></div><ul class="trm-table trm-mb-20"><li><div class="trm-label">Residence:</div><div class="trm-label trm-label-light">China</div></li><li><div class="trm-label">City:</div><div class="trm-label trm-label-light">Xi'An</div></li><li><div class="trm-label">Age:</div><div class="trm-label trm-label-light">33</div></li></ul><div class="trm-divider trm-mb-40 trm-mt-40"></div><div class="text-center"><a href="mailto:ycyplus@gmail.com" class="trm-btn">联系我 <i class="iconfont far fa-envelope"></i></a></div></div><div name="tabs-toc" class="trm-tabs-item active"><div class="post-toc"><ol class="toc"><li class="toc-item toc-level-2"><a rel="nofollow" class="toc-link" href="#JEST-框架的安装使用" data-scroll-to="#JEST-框架的安装使用"><span class="toc-number">1.</span> <span class="toc-text">JEST 框架的安装使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#JEST-的配置" data-scroll-to="#JEST-的配置"><span class="toc-number">1.1.</span> <span class="toc-text">JEST 的配置</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#JEST-中的匹配器" data-scroll-to="#JEST-中的匹配器"><span class="toc-number">1.2.</span> <span class="toc-text">JEST 中的匹配器</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#JEST-命令工具的使用" data-scroll-to="#JEST-命令工具的使用"><span class="toc-number">1.3.</span> <span class="toc-text">JEST 命令工具的使用</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#异步代码的测试方法" data-scroll-to="#异步代码的测试方法"><span class="toc-number">1.4.</span> <span class="toc-text">异步代码的测试方法</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#JEST-中的钩子函数" data-scroll-to="#JEST-中的钩子函数"><span class="toc-number">1.5.</span> <span class="toc-text">JEST 中的钩子函数</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#JEST-中的-Mock" data-scroll-to="#JEST-中的-Mock"><span class="toc-number">1.6.</span> <span class="toc-text">JEST 中的 Mock</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#JEST-中的-Snapshop-快照测试" data-scroll-to="#JEST-中的-Snapshop-快照测试"><span class="toc-number">1.7.</span> <span class="toc-text">JEST 中的 Snapshop 快照测试</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#ES6-中-类的测试-（单元测试）" data-scroll-to="#ES6-中-类的测试-（单元测试）"><span class="toc-number">1.8.</span> <span class="toc-text">ES6 中 类的测试 （单元测试）</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#JEST-中对-DOM-进行测试" data-scroll-to="#JEST-中对-DOM-进行测试"><span class="toc-number">1.9.</span> <span class="toc-text">JEST 中对 DOM 进行测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a rel="nofollow" class="toc-link" href="#Vue-中的-TDD" data-scroll-to="#Vue-中的-TDD"><span class="toc-number">2.</span> <span class="toc-text">Vue 中的 TDD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#Test-Driven-Development-TDD-测试驱动开发" data-scroll-to="#Test-Driven-Development-TDD-测试驱动开发"><span class="toc-number">2.1.</span> <span class="toc-text">Test Driven Development (TDD) 测试驱动开发</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#Vue-环境中配置-JEST" data-scroll-to="#Vue-环境中配置-JEST"><span class="toc-number">2.2.</span> <span class="toc-text">Vue 环境中配置 JEST</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#常用的一些-API" data-scroll-to="#常用的一些-API"><span class="toc-number">2.3.</span> <span class="toc-text">常用的一些 API</span></a></li></ol></li></ol></div></div></div></div></div></div><div id="page-content" class="col-lg-8"><div class="trm-content" id="trm-content"><div data-scroll data-scroll-repeat data-scroll-offset="500" id="about-triger"></div><div id="post-info" class="row hidden-sm"><div class="col-sm-4"><div class="trm-card trm-label trm-label-light text-center"><i class="iconfont far fa-calendar-alt trm-icon"></i><br>12/16</div></div><div class="col-sm-4"><div class="trm-card trm-label trm-label-light text-center"><i class="iconfont far fa-clock trm-icon"></i><br>14:36</div></div><div class="col-sm-4"><div id="post-author" class="trm-card trm-label trm-label-light text-center"><i class="iconfont far fa-user trm-icon"></i><br>Cheny</div></div></div><div class="trm-card"><article id="article-container" class="trm-publication"><p>前端自动化测试框架 JEST。</p><h2 id="JEST-框架的安装使用"><a href="#JEST-框架的安装使用" class="headerlink" title="JEST 框架的安装使用"></a>JEST 框架的安装使用</h2><p>安装：<code>npm install jest@24.8.0 -D</code> ，推荐使用这个版本。</p><p>package.json 文件的 script 里面的 test 修改如下：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line"><span class="comment">// 修改了以后 执行命令就会去找带test.js的后缀文件 并自动监听</span></span><br><span class="line">  <span class="string">&quot;test&quot;</span>: <span class="string">&quot;jest --watchAll&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>执行测试命令： <code>npm run test</code>。</p><ul><li>单元测试：模块测试。</li><li>集成测试：多模块测试。</li></ul><p>expect(要测试的)， .toBe(此方法期望的结果 ) 它是一个匹配器。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 注意，jest 测试框架支持 CommonJS 模块化规范</span></span><br><span class="line"><span class="comment">// xxx.test.js文件  ===&gt; 这是测试文件</span></span><br><span class="line"><span class="keyword">const</span> math = <span class="built_in">require</span>(<span class="string">&#x27;./math.js&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; add, minus, multi &#125; = math</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试加法 3 + 7&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">add</span>(<span class="number">3</span>, <span class="number">7</span>)).<span class="title function_">toBe</span>(<span class="number">10</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试减法 3 - 3&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">minus</span>(<span class="number">3</span>, <span class="number">3</span>)).<span class="title function_">toBe</span>(<span class="number">0</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试乘法 3 * 3&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">multi</span>(<span class="number">3</span>, <span class="number">3</span>)).<span class="title function_">toBe</span>(<span class="number">9</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是被测试文件  math.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">minus</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a - b</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">multi</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a * b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// 使浏览器不报错 使用 try catch</span></span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    add,</span><br><span class="line">    minus,</span><br><span class="line">    multi,</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="JEST-的配置"><a href="#JEST-的配置" class="headerlink" title="JEST 的配置"></a>JEST 的配置</h3><p>配置 JEST <code>npx jest --init</code>。</p><p>根据需要选择 <code>node</code> 或者 浏览器环境。<br>前三个都默认<code>yes</code> 会生成 <code>jest.config.js</code> 文件。<br>执行如下命令会生成测试覆盖率的申明 会生成一个 <code>coverage</code> 目录。</p><p><code>npx jest --coverage</code></p><p>使 JEST 识别 ES6 模块语法，需安装 babel <code>pm install @babel/core@7.4.5 @babel/preset-env@7.4.5 -D</code>。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 配置babel 新建.babelrc 文件进行配置</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;presets&quot;</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;@babel/preset-env&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;targets&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;node&quot;</span>: <span class="string">&quot;current&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 这样就可以使用 ES6的模块语法</span></span><br></pre></td></tr></table></figure><h3 id="JEST-中的匹配器"><a href="#JEST-中的匹配器" class="headerlink" title="JEST 中的匹配器"></a>JEST 中的匹配器</h3><ol><li>测试值相等，它无法匹配对象内容的引用</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试加法 3 + 7&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// toBe 匹配器 matchers 相当于 object.js ===</span></span><br><span class="line">  <span class="comment">// 字符串 数值 布尔值 简单类型推荐使用</span></span><br><span class="line">  <span class="title function_">expect</span>(<span class="number">10</span>).<span class="title function_">toBe</span>(<span class="number">10</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="2"><li>测试对象内容相等</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试对象内容相等&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// toEqual 匹配器 引用类型推荐使用</span></span><br><span class="line">  <span class="keyword">const</span> a = &#123; <span class="attr">one</span>: <span class="number">1</span> &#125;</span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toEqual</span>(&#123; <span class="attr">one</span>: <span class="number">1</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="3"><li>变量和 null 进行匹配</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;null匹配器&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// toBeNull 匹配器</span></span><br><span class="line">  <span class="keyword">const</span> a = <span class="literal">null</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeNull</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>真假有关的匹配器</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeUndefined 匹配器&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="literal">undefined</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeUndefined</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeDefined 匹配器&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">1</span> <span class="comment">// 定义过的才可以</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeDefined</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeTruthy 相当于true匹配器&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">  <span class="comment">// 判断是否为真的匹配器 相当于 true 的条件才可以</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeFalsy 相当于false匹配器&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">0</span></span><br><span class="line">  <span class="comment">// 判断是否为假的匹配器 相当于 false 的条件才可以</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeFalsy</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;not 取反匹配器&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">1</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="property">not</span>.<span class="title function_">toBeFalsy</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="5"><li>数字相关的 匹配器</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 大于匹配器</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeGreaterThan&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">10</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeGreaterThan</span>(<span class="number">9</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 小于匹配器</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeLessThan&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">6</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeLessThan</span>(<span class="number">9</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 大于等于匹配器</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeGreaterThanOrEqual&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">6</span></span><br><span class="line">  <span class="title function_">expect</span>(a).<span class="title function_">toBeGreaterThanOrEqual</span>(<span class="number">6</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理浮点数</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toBeCloseTo&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">0.1</span></span><br><span class="line">  <span class="keyword">const</span> b = <span class="number">0.2</span></span><br><span class="line">  <span class="title function_">expect</span>(a + b).<span class="title function_">toBeCloseTo</span>(<span class="number">0.3</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="6"><li>字符串相关的匹配器</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 是否包含某个字符串</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toMatch&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> str = <span class="string">&#x27;http://www.dell-lee.com&#x27;</span></span><br><span class="line">  <span class="title function_">expect</span>(str).<span class="title function_">toMatch</span>(<span class="string">&#x27;dell&#x27;</span>) <span class="comment">// 也可以写表达式</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="7"><li>数组相关的匹配器</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 是否数组包含某个项</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toContain&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> arr = [<span class="string">&#x27;dell&#x27;</span>, <span class="string">&#x27;lee&#x27;</span>, <span class="string">&#x27;imooc&#x27;</span>]</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">new</span> <span class="title class_">Set</span>(arr)</span><br><span class="line">  <span class="title function_">expect</span>(data).<span class="title function_">toContain</span>(<span class="string">&#x27;dell&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="8"><li>处理异常的匹配器</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 异常</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">throwNewErrorFunc</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;this is a new error&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;toThrow&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(throwNewErrorFunc).<span class="title function_">toThrow</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>🔔 注意：如果当一个文件中测试用例过多，只针对其中一个进行测试，可以添加.only。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 比如</span></span><br><span class="line">test.<span class="title function_">only</span>(<span class="string">&#x27;测试 Counter 中的 addOne 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counter.<span class="title function_">addOne</span>()</span><br><span class="line">  <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="JEST-命令工具的使用"><a href="#JEST-命令工具的使用" class="headerlink" title="JEST 命令工具的使用"></a>JEST 命令工具的使用</h3><p>当执行测试命令 npm run test 测试代码的时候会提示 <code>w</code> 切换。</p><p>f : f 的意思是 只对之前当前文件测试失败的代码进行测试 退出在 f。<br>o : 当有多个测试文件测试的时候，需要使用它 或者改 watchAll 为 watch。<br>t : 过滤模式 需要针对 pattern 输入对应要检测的模式。<br>q : 退出模式。<br>p : 它的作用是类似正则一样，检测比如 输入 matchers 它就会去找类似的文件。</p><h3 id="异步代码的测试方法"><a href="#异步代码的测试方法" class="headerlink" title="异步代码的测试方法"></a>异步代码的测试方法</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 回调方法一：</span></span><br><span class="line">.<span class="property">js</span>文件</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">fetchData</span> = (<span class="params">fn</span>) =&gt; &#123;</span><br><span class="line">  axios.<span class="title function_">get</span>(<span class="string">&#x27;http://www.dell-lee.com/react/api/demo.json&#x27;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">fn</span>(res.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用 done 作为回调的第二个参数，否则不执行后面的语句</span></span><br><span class="line">.<span class="property">test</span>.<span class="property">js</span>文件</span><br><span class="line"><span class="keyword">import</span> &#123; fetchData &#125; <span class="keyword">from</span> <span class="string">&#x27;./fetchDate&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 &#123; success: true &#125;&#x27;</span>, <span class="function">(<span class="params">done</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">fetchData</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(data).<span class="title function_">toEqual</span>(&#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">done</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 方法2 直接返回Promise 推荐</span></span><br><span class="line">.<span class="property">js</span> 文件</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">fetchData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;http://www.dell-lee.com/react/api/demo.json&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">.<span class="property">test</span>.<span class="property">js</span> 文件</span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 &#123; success: true &#125;&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetchData</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(res.<span class="property">data</span>).<span class="title function_">toEqual</span>(&#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果需要满足404 类似错误的结果</span></span><br><span class="line"><span class="comment">// 比如 输错了请求地址</span></span><br><span class="line">.<span class="property">test</span>.<span class="property">js</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 404&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect.<span class="title function_">assertions</span>(<span class="number">1</span>)  <span class="comment">// 使用 catch 一定记得用它</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetchData</span>().<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(e.<span class="title function_">toString</span>().<span class="title function_">indexOf</span>(<span class="string">&#x27;404&#x27;</span>) &gt; <span class="number">1</span>).<span class="title function_">toBe</span>(<span class="literal">true</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="另一种处理异步代码的测试方法"><a href="#另一种处理异步代码的测试方法" class="headerlink" title="另一种处理异步代码的测试方法"></a>另一种处理异步代码的测试方法</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 &#123; success: true &#125;&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 是否包含这个子对象</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">expect</span>(<span class="title function_">fetchData</span>()).<span class="property">resolves</span>.<span class="title function_">toMatchObject</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------  还可以用 async await 方式写</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 404&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  expect.<span class="title function_">assertions</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">fetchData</span>().<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(e.<span class="title function_">toString</span>().<span class="title function_">indexOf</span>(<span class="string">&#x27;404&#x27;</span>) &gt; <span class="number">1</span>).<span class="title function_">toBe</span>(<span class="literal">true</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试处理失败的情况</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 &#123; success: true &#125;&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">expect</span>(<span class="title function_">fetchData</span>()).<span class="property">rejects</span>.<span class="title function_">toThrow</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="推荐写法"><a href="#推荐写法" class="headerlink" title="推荐写法"></a>推荐写法</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 &#123; success: true &#125;&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetchData</span>()</span><br><span class="line">  <span class="title function_">expect</span>(res.<span class="property">data</span>).<span class="title function_">toEqual</span>(&#123;</span><br><span class="line">    <span class="attr">success</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理错误</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchData 返回结果为 404&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  expect.<span class="title function_">assertions</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">fetchData</span>()</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="title function_">expect</span>(e.<span class="title function_">toString</span>()).<span class="title function_">toEqual</span>(<span class="string">&#x27;Error: Request failed with status code 404&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="JEST-中的钩子函数"><a href="#JEST-中的钩子函数" class="headerlink" title="JEST 中的钩子函数"></a>JEST 中的钩子函数</h3><p>不使用钩子函数的情况，会有一些问题：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 比如有这么一个例子：</span></span><br><span class="line">.<span class="property">js</span> 文件</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">number</span> = <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">addOne</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">number</span> += <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">minusOne</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">number</span> -= <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">.<span class="property">test</span>.<span class="property">js</span> 文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Counter</span> <span class="keyword">from</span> <span class="string">&#x27;./Counter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果要在测试之前对一些公共信初始化 推荐使用钩子函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counter = <span class="keyword">new</span> <span class="title class_">Counter</span>  <span class="comment">// 这样初始化测试的时候其实有问题</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 addOne 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counter.<span class="title function_">addOne</span>()</span><br><span class="line">  <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 minusOne 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counter.<span class="title function_">minusOne</span>()</span><br><span class="line">  <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(<span class="number">0</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 这样在测试过程中，第二个方法执行就会以第一个方法执行为标准，耦合度高</span></span><br><span class="line"><span class="comment">// 不是想要得到的结果，addOne + 1了 minusOne又在addOne基础上-1</span></span><br><span class="line"><span class="comment">// 相互之间存在依赖</span></span><br></pre></td></tr></table></figure><p>如果要在测试之前对一些公共信初始化 推荐使用钩子函数 <code>beforeEach</code>。</p><ul><li><code>beforeAll( ()=&gt;&#123;&#125; )</code> 第一个运行的钩子函数。</li><li><code>befaoreEach( ()=&gt;&#123;&#125; )</code> 当每个测试用例执行之前，都先执行下 <code>beforeEach</code> 钩子函数。</li><li><code>afterEach( ()=&gt;&#123;&#125; )</code> 当每个测试用例执行之后 都会执行这个钩子函数。</li><li><code>afterAll( ()=&gt;&#123;&#125; )</code> 等待所有的测试用例结束后执行的钩子函数。</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Counter</span> <span class="keyword">from</span> <span class="string">&#x27;./Counter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果要在测试之前对一些公共信初始化 推荐使用钩子函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counter = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counter = <span class="keyword">new</span> <span class="title class_">Counter</span>() <span class="comment">// 将初始化工作放入 beforeEach 中</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 addOne 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counter.<span class="title function_">addOne</span>()</span><br><span class="line">  <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 minusOne 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counter.<span class="title function_">minusOne</span>()</span><br><span class="line">  <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(-<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>分组钩子：</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Counter</span> <span class="keyword">from</span> <span class="string">&#x27;./Counter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果要在测试之前对一些公共信初始化 推荐使用钩子函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counter = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  counter = <span class="keyword">new</span> <span class="title class_">Counter</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;测试跟加相关的代码&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 addOne 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    counter.<span class="title function_">addOne</span>()</span><br><span class="line">    <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(<span class="number">1</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 addTwo 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    counter.<span class="title function_">addTwo</span>()</span><br><span class="line">    <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(<span class="number">2</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;测试跟减相关的代码&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 minusOne 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    counter.<span class="title function_">minusOne</span>()</span><br><span class="line">    <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(-<span class="number">1</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;测试 Counter 中的 minusTwo 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    counter.<span class="title function_">minusTwo</span>()</span><br><span class="line">    <span class="title function_">expect</span>(counter.<span class="property">number</span>).<span class="title function_">toBe</span>(-<span class="number">2</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>钩子函数的作用域：</p><p>钩子函数的作用域跟作用域链的基本差不多，每一个 <code>describe</code> 里面都可以有自己的钩子函数，最外层的 <code>describe</code> 里面的钩子函数可以作用域内部 <code>describe</code> 的测试用例。</p><h3 id="JEST-中的-Mock"><a href="#JEST-中的-Mock" class="headerlink" title="JEST 中的 Mock"></a>JEST 中的 Mock</h3><p>作用：</p><ol><li>捕获函数的调用和返回结果，以及 this 和调用顺序。</li><li>它可以自由的设置返回结果。</li><li>改变内部函数的实现，比如下面的 测试 axios 请求。</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js 文件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">runCallback</span> = (<span class="params">callback</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">callback</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .test.js 文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; runCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 runCallbaack&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> func = jest.<span class="title function_">fn</span>() <span class="comment">// jest 提供的 mock 函数</span></span><br><span class="line">  <span class="title function_">runCallback</span>(func)</span><br><span class="line">  <span class="title function_">expect</span>(func).<span class="title function_">toBeCalled</span>() <span class="comment">// 判断函数是否被调用过</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果多次调用</span></span><br><span class="line"><span class="keyword">import</span> &#123; runCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 runCallbaack&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> func = jest.<span class="title function_">fn</span>() <span class="comment">// jest 提供的 mock 函数</span></span><br><span class="line">  <span class="title function_">runCallback</span>(func)</span><br><span class="line">  <span class="title function_">runCallback</span>(func)</span><br><span class="line">  <span class="comment">// func.mock.calls.length 拿到调用的次数</span></span><br><span class="line">  <span class="title function_">expect</span>(func.<span class="property">mock</span>.<span class="property">calls</span>.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">2</span>) <span class="comment">// 断言 比如上面调用了两次</span></span><br><span class="line">  <span class="comment">// 类似于 expect(func).toBeCalledWith([&#x27;abc&#x27;])</span></span><br><span class="line">  <span class="comment">// 区别在于 上面是第一次调用的时候参数是 abc 下面是每一次调用是 abc</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(func.<span class="property">mock</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果要拿到传递的参数</span></span><br><span class="line"><span class="comment">// .js文件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">runCallback</span> = (<span class="params">callback</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="string">&#x27;abc&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">.<span class="property">test</span>.<span class="property">js</span>文件</span><br><span class="line"><span class="keyword">import</span> &#123; runCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 runCallbaack&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> func = jest.<span class="title function_">fn</span>();  <span class="comment">// jest 提供的 mock 函数</span></span><br><span class="line">  <span class="title function_">runCallback</span>(func);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(func.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">0</span>]);</span><br><span class="line">  <span class="comment">// 通过 func.mock.call[0]</span></span><br><span class="line">  <span class="title function_">expect</span>(func.<span class="property">mock</span>.<span class="property">calls</span>[<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&#x27;abc&#x27;</span>])</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果要单独设置返回值</span></span><br><span class="line"><span class="keyword">import</span> &#123; runCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 runCallbaack&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> func = jest.<span class="title function_">fn</span>();  <span class="comment">// jest 提供的 mock 函数</span></span><br><span class="line">  <span class="comment">// 它支持链式操作 Once 是每次设置一个 不加Once 就全部添加</span></span><br><span class="line">  func.<span class="title function_">mockReturnValueOnce</span>(<span class="string">&#x27;Dell&#x27;</span>)</span><br><span class="line">    .<span class="title function_">mockReturnValueOnce</span>(<span class="string">&#x27;Lee&#x27;</span>)</span><br><span class="line">    .<span class="title function_">mockReturnValueOnce</span>(<span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line">    <span class="comment">// 还有种写法更底层强悍 可以写一个逻辑处理</span></span><br><span class="line">    <span class="comment">// func.mockImplementationOnce(()=&gt;&#123;  // 也可以不带Once</span></span><br><span class="line">        <span class="comment">// return &#x27;dell&#x27;</span></span><br><span class="line">        <span class="comment">// console.log(...) 等等逻辑</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">    <span class="title function_">runCallback</span>(func);</span><br><span class="line">  <span class="title function_">runCallback</span>(func);</span><br><span class="line">  <span class="title function_">runCallback</span>(func);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(func.<span class="property">mock</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>测试 axios 请求：</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js 文件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/api&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="property">data</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ---------------------------</span></span><br><span class="line">.<span class="property">test</span>.<span class="property">js</span> 文件</span><br><span class="line"><span class="keyword">import</span> &#123; runCallback, createObject, getData &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;axios&#x27;</span>); <span class="comment">// jset 对 axios 做一个模拟</span></span><br><span class="line">test.<span class="title function_">only</span>(<span class="string">&#x27;测试 getDate&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  axios.<span class="property">get</span>.<span class="title function_">mockResolvedValue</span>(&#123; <span class="attr">data</span>: <span class="string">&#x27;hello&#x27;</span> &#125;)</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">getData</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(data).<span class="title function_">toBe</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>如果要返回 <code>this</code>，可以使用 <code>func.mockReturnThis()</code>，了解即可！</p><p><strong>mock 的深入学习：</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">fetchData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> res.<span class="property">data</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//.test.js</span></span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;./demo&#x27;</span>) <span class="comment">// 使用的是 __mocaks__ 里面的demo文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; fetchData &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchDate 测试&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetchData</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="built_in">eval</span>(data)).<span class="title function_">toEqual</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 注意新建 __mocks__ 下面在建.js文件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">fetchData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&quot;(function()&#123;return &#x27;123&#x27;&#125;())&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 另一种方法 修改 config.js 里面的 automocak: true</span></span><br></pre></td></tr></table></figure><p>如果即有需要 <code>mock</code> 的 <code>axios</code> 请求 又有非 <code>axios</code> 数据 就要这么写，不模拟真实就要用 <code>jest.requireActual</code>。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">fetchData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> res.<span class="property">data</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getNumber</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .test.js</span></span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;./demo&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> &#123; fetchData &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line"><span class="comment">// 注意，使用真实的 ./demo.js 而不是 __mocks__里面的.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; getNumber &#125; = jest.requireActual(<span class="string">&#x27;./demo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;fetchDate 测试&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetchData</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="built_in">eval</span>(data)).<span class="title function_">toEqual</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面针对进行测试</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">`getNumber 测试`</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">getNumber</span>()).<span class="title function_">toEqual</span>(<span class="number">123</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>mock timers</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js 文件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (callback) =&gt; &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>()</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>()</span><br><span class="line">    &#125;, <span class="number">3000</span>)</span><br><span class="line">  &#125;, <span class="number">3000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .test.js 文件</span></span><br><span class="line"><span class="comment">// 解决方法一：</span></span><br><span class="line"><span class="keyword">import</span> timer <span class="keyword">from</span> <span class="string">&#x27;./timer&#x27;</span></span><br><span class="line"><span class="comment">// 使用这个方法</span></span><br><span class="line">jest.<span class="title function_">useFakeTimers</span>()</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;timer 测试&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> fn = jest.<span class="title function_">fn</span>()</span><br><span class="line">  <span class="title function_">timer</span>(fn)</span><br><span class="line">  <span class="comment">// 使定时器立即执行</span></span><br><span class="line">  jest.<span class="title function_">runAllTimers</span>()</span><br><span class="line">  <span class="comment">// 希望被调用几次，因为上面.js调用了两次</span></span><br><span class="line">  <span class="title function_">expect</span>(fn).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">2</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 推荐解决方案：</span></span><br><span class="line"><span class="keyword">import</span> timer <span class="keyword">from</span> <span class="string">&#x27;./timer&#x27;</span></span><br><span class="line">jest.<span class="title function_">useFakeTimers</span>()</span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;timer 测试&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> fn = jest.<span class="title function_">fn</span>()</span><br><span class="line">  <span class="title function_">timer</span>(fn)</span><br><span class="line">  <span class="comment">// 让时间快进设置的延时时间</span></span><br><span class="line">  jest.<span class="title function_">advanceTimersByTime</span>(<span class="number">3000</span>)</span><br><span class="line">  <span class="title function_">expect</span>(fn).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">1</span>)</span><br><span class="line">  jest.<span class="title function_">advanceTimersByTime</span>(<span class="number">3000</span>)</span><br><span class="line">  <span class="title function_">expect</span>(fn).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">2</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// -----------  分割线  ------------</span></span><br><span class="line"><span class="comment">// 如果想每个测试互不影响，因为推荐解决方案会基于上次结束再次执行</span></span><br><span class="line"><span class="keyword">import</span> timer <span class="keyword">from</span> <span class="string">&#x27;./timer&#x27;</span></span><br><span class="line"><span class="comment">// 将它包裹在 beforeEach 钩子函数中</span></span><br><span class="line"><span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  jest.<span class="title function_">useFakeTimers</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;timer 测试&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> fn = jest.<span class="title function_">fn</span>()</span><br><span class="line">  <span class="title function_">timer</span>(fn)</span><br><span class="line">  <span class="comment">// 让时间快进设置的延时时间</span></span><br><span class="line">  jest.<span class="title function_">advanceTimersByTime</span>(<span class="number">3000</span>)</span><br><span class="line">  <span class="title function_">expect</span>(fn).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">1</span>)</span><br><span class="line">  jest.<span class="title function_">advanceTimersByTime</span>(<span class="number">3000</span>)</span><br><span class="line">  <span class="title function_">expect</span>(fn).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">2</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="JEST-中的-Snapshop-快照测试"><a href="#JEST-中的-Snapshop-快照测试" class="headerlink" title="JEST 中的 Snapshop 快照测试"></a>JEST 中的 Snapshop 快照测试</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">generateConfig</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">server</span>: <span class="string">&#x27;http://localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">post</span>: <span class="number">8080</span>,</span><br><span class="line">    <span class="attr">domain</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//.test.js 文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; generateConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 generateConfig&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">generateConfig</span>()).<span class="title function_">toMatchSnapshot</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 会生成对应的快照文件</span></span><br></pre></td></tr></table></figure><p><strong>当配置文件是变化的情况下：</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">generateConfig</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">server</span>: <span class="string">&#x27;http://localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">post</span>: <span class="number">8080</span>,</span><br><span class="line">    <span class="attr">domain</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">time</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">generateConfig1</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">server</span>: <span class="string">&#x27;http://localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">post</span>: <span class="number">8086</span>,</span><br><span class="line">    <span class="attr">domain</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">time</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// .test.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; generateConfig, generateConfig1 &#125; <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 generateConfig&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">generateConfig</span>()).<span class="title function_">toMatchSnapshot</span>(&#123;</span><br><span class="line">    <span class="attr">time</span>: expect.<span class="title function_">any</span>(<span class="title class_">Date</span>),</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 generateConfig1&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">generateConfig1</span>()).<span class="title function_">toMatchSnapshot</span>(&#123;</span><br><span class="line">    <span class="attr">time</span>: expect.<span class="title function_">any</span>(<span class="title class_">Date</span>),</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>行内快照 toMatchInlineSnapshot</strong></p><p>安装模块 <code>npm install prettier@1.18.2 --save</code></p><p>栗如下：放在到测试用例下面</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 generateConfig1&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">generateConfig1</span>()).<span class="title function_">toMatchInlineSnapshot</span>(</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">time</span>: expect.<span class="title function_">any</span>(<span class="title class_">Date</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">`  // 行内快照 放到了测试用例下面</span></span><br><span class="line"><span class="string">    Object &#123;</span></span><br><span class="line"><span class="string">      &quot;domain&quot;: &quot;localhost&quot;,</span></span><br><span class="line"><span class="string">      &quot;post&quot;: 8086,</span></span><br><span class="line"><span class="string">      &quot;server&quot;: &quot;http://localhost&quot;,</span></span><br><span class="line"><span class="string">      &quot;time&quot;: Any&lt;Date&gt;,</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="ES6-中-类的测试-（单元测试）"><a href="#ES6-中-类的测试-（单元测试）" class="headerlink" title="ES6 中 类的测试 （单元测试）"></a>ES6 中 类的测试 （单元测试）</h3><p>单元测试就是利用 <code>mock</code> 来提升性能的测试。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// util.js</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Util</span> &#123;</span><br><span class="line">  <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...很复杂的逻辑</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">b</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...很复杂的逻辑</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Util</span></span><br><span class="line"><span class="comment">// util.test.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Util</span> <span class="keyword">from</span> <span class="string">&#x27;./util&#x27;</span></span><br><span class="line"><span class="keyword">let</span> util = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">beforeAll</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  util = <span class="keyword">new</span> <span class="title class_">Util</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 a 方法&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// expect(util.a(1, 2)).toBe(&#x27;12&#x27;);</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// test.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Util</span> <span class="keyword">from</span> <span class="string">&#x27;./util&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">testFunction</span> = (<span class="params">a, b</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> util = <span class="keyword">new</span> <span class="title class_">Util</span>();</span><br><span class="line">  util.<span class="title function_">a</span>(a);</span><br><span class="line">  util.<span class="title function_">b</span>(b);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> testFunction;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .test.test.js</span></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;./util&#x27;</span>);</span><br><span class="line"><span class="comment">// 底层会把 Util下面的a,b会变成 jest.fn.a/b</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Util</span> <span class="keyword">from</span> <span class="string">&#x27;./util&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> testFunction <span class="keyword">from</span> <span class="string">&#x27;./test&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 testFunction&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">testFunction</span>();</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title class_">Util</span>).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">  <span class="comment">// 针对上文的类中的两个方法a/b进行测试</span></span><br><span class="line">  <span class="title function_">expect</span>(<span class="title class_">Util</span>.<span class="property">mock</span>.<span class="property">instances</span>[<span class="number">0</span>].<span class="property">a</span>).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title class_">Util</span>.<span class="property">mock</span>.<span class="property">instances</span>[<span class="number">0</span>].<span class="property">b</span>).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="JEST-中对-DOM-进行测试"><a href="#JEST-中对-DOM-进行测试" class="headerlink" title="JEST 中对 DOM 进行测试"></a>JEST 中对 DOM 进行测试</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .js</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&#x27;jquery&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addDivToBody</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  $(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;div&gt;&lt;/div&gt;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> addDivToBody</span><br><span class="line"></span><br><span class="line"><span class="comment">//.test.js</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&#x27;jquery&#x27;</span></span><br><span class="line"><span class="keyword">import</span> addDivToBody <span class="keyword">from</span> <span class="string">&#x27;./demo&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;测试 addDivToBody&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">addDivToBody</span>()</span><br><span class="line">  <span class="title function_">expect</span>($(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">find</span>(<span class="string">&#x27;div&#x27;</span>).<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="Vue-中的-TDD"><a href="#Vue-中的-TDD" class="headerlink" title="Vue 中的 TDD"></a>Vue 中的 TDD</h2><h3 id="Test-Driven-Development-TDD-测试驱动开发"><a href="#Test-Driven-Development-TDD-测试驱动开发" class="headerlink" title="Test Driven Development (TDD) 测试驱动开发"></a>Test Driven Development (TDD) 测试驱动开发</h3><p>TDD 开发流程 （Red-Green） 从红到绿的一种开发模式，因为前期测试代码一片红。</p><ol><li>编写测试用例</li><li>运行测试用例，测试用例无法通过测试</li><li>编写代码，使测试用例通过</li><li>优化代码，完成开发</li><li>重复上述步骤</li></ol><p><strong>TDD 的优势：</strong></p><ul><li>长期减少回归 bug (编写代码过程中，测试代码及时提示)。</li><li>代码质量更好（组织，可维护性）。</li><li>测试覆盖率高。</li><li>错误的测试代码不容易出现。</li></ul><h3 id="Vue-环境中配置-JEST"><a href="#Vue-环境中配置-JEST" class="headerlink" title="Vue 环境中配置 JEST"></a>Vue 环境中配置 JEST</h3><p><code>package.json</code> 中 <code>test:unit</code> 尾部添加 <code>--watch</code>。</p><p><code>@vue/test-utils</code> 的配置及使用。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 修改 jest.config.js 配置文件如下信息：</span></span><br><span class="line"><span class="attr">testMatch</span>: [</span><br><span class="line">  <span class="string">&#x27;**/tests/unit/**/*.(spec|test).(js|jsx|ts|tsx)|**/__tests__/*.(js|jsx|ts|tsx)&#x27;</span></span><br><span class="line">],</span><br></pre></td></tr></table></figure><p>用例：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 浅渲染，只会渲染当前组件，不会影响子组件</span></span><br><span class="line"><span class="keyword">import</span> &#123; shallowMount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span></span><br><span class="line"><span class="comment">// 只对当前组件 HelloWorld 组件进行浅渲染</span></span><br><span class="line"><span class="keyword">const</span> wrapper = <span class="title function_">shallowMount</span>(<span class="title class_">HelloWorld</span>, &#123;</span><br><span class="line">  <span class="attr">propsData</span>: &#123; msg &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// wrapper 的几个方法</span></span><br><span class="line">wrapper.<span class="title function_">text</span>() 可以得到当前组件的文本信息</span><br><span class="line">wrapper.<span class="title function_">props</span>(<span class="string">&#x27;msg&#x27;</span>) 也可以拿到对应的 props 信息</span><br><span class="line">wrapper.<span class="title function_">setProps</span>(&#123;<span class="attr">msg</span>: <span class="string">&#x27;hello&#x27;</span>&#125;)</span><br><span class="line">wrapper.<span class="title function_">find</span>() 可以查找它的类名等信息</span><br><span class="line">wrapper.<span class="title function_">findAll</span>() 同上 查询多个</span><br><span class="line"><span class="comment">// 使用findAll拿数据要这样拿记得 at()----&gt; expect(countElem.at(0).text()).toEqual(&#x27;0&#x27;)</span></span><br><span class="line"><span class="title function_">expect</span>(wrapper).<span class="title function_">toMatchSnapshot</span>()  快照测试</span><br><span class="line"><span class="comment">// 深渲染，对子组件也会影响</span></span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="常用的一些-API"><a href="#常用的一些-API" class="headerlink" title="常用的一些 API"></a>常用的一些 API</h3><ul><li><code>const input = wrapper.find(&#39;[data-test=&quot;input&quot;]&#39;)</code> 自定义 input 属性 判断节点是否存在。</li><li><code>expect(input.exists()).toBe(true)</code> 判断 <code>input</code> 是否存在。</li><li><code>wrapper.vm.$data.</code> 方式拿到 <code>vue</code> 里面组件的 <code>data</code> 实例的属性。</li><li><code>input.setValue(&#39;&#39;)</code> 设置 <code>input</code> 的属性。</li><li><code>input.trigger(&#39;keyup.enter&#39;)</code> 触发一个方法，模拟用户输入回车。</li><li><code>expect(wrapper.emitted().add).toBeFalsy()</code> 判断是否有触发这个事件。</li><li><code>wrapper.vm.</code>方法名 方式拿到 <code>vue</code> 里面组件的 <code>methods</code> 的方法。</li></ul><p>实例：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Header</span> <span class="keyword">from</span> <span class="string">&#x27;../../components/Header&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;Header 包含 input 框&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">shallowMount</span>(<span class="title class_">Header</span>)</span><br><span class="line">  <span class="comment">// 通过自定义属性来区分是否有这个标签</span></span><br><span class="line">  <span class="keyword">const</span> input = wrapper.<span class="title function_">find</span>(<span class="string">&#x27;[data-test=&quot;input&quot;]&#x27;</span>)</span><br><span class="line">  <span class="comment">// input 是否存在 API 在 vue-test-utils</span></span><br><span class="line">  <span class="title function_">expect</span>(input.<span class="title function_">exists</span>()).<span class="title function_">toBe</span>(<span class="literal">true</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;Header 中 input 框初始内容为空&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">shallowMount</span>(<span class="title class_">Header</span>)</span><br><span class="line">  <span class="comment">// 找到这个 new 的实例</span></span><br><span class="line">  <span class="comment">// 通过 wrapper.vn.$data 拿到 VUE 实例里面 data 的属性</span></span><br><span class="line">  <span class="keyword">const</span> inputValue = wrapper.<span class="property">vm</span>.<span class="property">$data</span>.<span class="property">inputValue</span></span><br><span class="line">  <span class="title function_">expect</span>(inputValue).<span class="title function_">toBe</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;Header 中 input 框输入回车 无内容时，无反应&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">shallowMount</span>(<span class="title class_">Header</span>)</span><br><span class="line">  <span class="keyword">const</span> input = wrapper.<span class="title function_">find</span>(<span class="string">&#x27;[data-test=&quot;input&quot;]&#x27;</span>)</span><br><span class="line">  <span class="comment">// 设置 input 的属性</span></span><br><span class="line">  input.<span class="title function_">setValue</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="comment">// 触发一个方法 模拟用户输入回车</span></span><br><span class="line">  input.<span class="title function_">trigger</span>(<span class="string">&#x27;keyup.enter&#x27;</span>)</span><br><span class="line">  <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>().<span class="property">add</span>).<span class="title function_">toBeFalsy</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;Header 中 input 框输入回车 有内容时，向外触发事件&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">shallowMount</span>(<span class="title class_">Header</span>)</span><br><span class="line">  <span class="keyword">const</span> input = wrapper.<span class="title function_">find</span>(<span class="string">&#x27;[data-test=&quot;input&quot;]&#x27;</span>)</span><br><span class="line">  input.<span class="title function_">setValue</span>(<span class="string">&#x27;dell lee&#x27;</span>)</span><br><span class="line">  <span class="comment">// 触发一个方法 模拟用户输入回车</span></span><br><span class="line">  input.<span class="title function_">trigger</span>(<span class="string">&#x27;keyup.enter&#x27;</span>)</span><br><span class="line">  <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>().<span class="property">add</span>).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;Header 中 input 框输入回车 有内容时，向外触发事件 同时清空 inputValue&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">shallowMount</span>(<span class="title class_">Header</span>)</span><br><span class="line">  <span class="keyword">const</span> input = wrapper.<span class="title function_">find</span>(<span class="string">&#x27;[data-test=&quot;input&quot;]&#x27;</span>)</span><br><span class="line">  input.<span class="title function_">setValue</span>(<span class="string">&#x27;dell lee&#x27;</span>)</span><br><span class="line">  <span class="comment">// 触发一个方法 模拟用户输入回车</span></span><br><span class="line">  input.<span class="title function_">trigger</span>(<span class="string">&#x27;keyup.enter&#x27;</span>)</span><br><span class="line">  <span class="title function_">expect</span>(wrapper.<span class="property">vm</span>.<span class="property">$data</span>.<span class="property">inputValue</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>npm run lint --fix</code> 会自动把不规范的代码 按照 <code>lint</code> 自动规范化代码。</p></article><div class="trm-reward"><span class="trm-reward-btn trm-glow" onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'><i class="iconfont fas fa-hand-holding-usd"></i></span><p class="trm-reward-comment">我很可爱，请给我钱</p><div id="qr" style="display:none"><div style="display:inline-block"><a rel="noopener" href="https://cheny-chenyu.oss-cn-chengdu.aliyuncs.com/img/weixin-pay.png" target="_blank"><img src="https://cheny-chenyu.oss-cn-chengdu.aliyuncs.com/img/weixin-pay.png" alt="微信" loading="lazy"></a><p>微信</p></div><div style="display:inline-block"><a rel="noopener" href="https://cheny-chenyu.oss-cn-chengdu.aliyuncs.com/img/zhifubao-pay.png" target="_blank"><img src="https://cheny-chenyu.oss-cn-chengdu.aliyuncs.com/img/zhifubao-pay.png" alt="支付宝" loading="lazy"></a><p>支付宝</p></div></div></div><ul class="trm-post-copyright"><li class="trm-post-copyright-author"><strong>本文作者：</strong> Cheny</li><li class="trm-post-copyright-link"><strong>本文链接：</strong> <a id="original-link" href="https://www.yangchenyu.com/test/" title="前端自动化测试 【JEST】">https://www.yangchenyu.com/test/</a></li><li class="trm-post-copyright-license"><strong>版权声明：</strong> 本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 ">CC BY-NC-SA 4.0</a> 许可协议。</li></ul></div><div id="post-next-prev" class="row"><div class="col-lg-12"><h5 class="trm-title-with-divider">其他文章 <span data-number="02"></span></h5></div><div class="col-lg-6"><div class="trm-blog-card trm-scroll-animation" data-scroll data-scroll-offset="40"><a href="/flutter_basic_widget/" class="trm-cover-frame trm-anima-link"><img alt="cover" class="no-fancybox" src="https://images.unsplash.com/photo-1592424002053-21f369ad7fdb?ixid=Mnw4OTgyNHwwfDF8c2VhcmNofDM2fHxjb2RlfGVufDB8fHx8MTY1MDEyNTAxMg&ixlib=rb-1.2.1&w=750&dpi=2"></a><div class="trm-card-descr"><div class="trm-label trm-category trm-mb-20"><a href="/categories/%E8%AE%B0%E5%BD%95%E7%B1%BB/">记录类</a></div><h5><a href="/flutter_basic_widget/" class="trm-anima-link">Flutter 常用小部件(一)</a></h5><div class="trm-divider trm-mb-20 trm-mt-20"></div><ul class="trm-card-data trm-label"><li>21/01/08</li><li>22:23</li></ul></div></div></div><div class="col-lg-6"><div class="trm-blog-card trm-scroll-animation" data-scroll data-scroll-offset="40"><a href="/vue_keep_alive/" class="trm-cover-frame trm-anima-link"><img alt="cover" class="no-fancybox" src="https://images.unsplash.com/photo-1467232004584-a241de8bcf5d?ixid=Mnw4OTgyNHwwfDF8c2VhcmNofDh8fHdlYnxlbnwwfHx8fDE2NTAxMjU0OTk&ixlib=rb-1.2.1&w=750&dpi=2"></a><div class="trm-card-descr"><div class="trm-label trm-category trm-mb-20"><a href="/categories/%E8%AE%B0%E5%BD%95%E7%B1%BB/">记录类</a></div><h5><a href="/vue_keep_alive/" class="trm-anima-link">keep-alive 与 router-view</a></h5><div class="trm-divider trm-mb-20 trm-mt-20"></div><ul class="trm-card-data trm-label"><li>20/12/07</li><li>20:07</li></ul></div></div></div></div><div class="trm-divider footer-divider"></div><footer class="trm-scroll-animation" data-scroll data-scroll-offset="50"><div class="trm-footer-item"><span>© 2019- 2024</span> <span class="footer-separator" data-separator=" · "></span> <span class="trm-accent-color">CHENY</span></div><div class="trm-footer-item"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.4.2 </span><span class="footer-separator" data-separator=" | "></span> <span>主题 - <a rel="noopener" href="https://github.com/MaLuns/hexo-theme-async" target="_blank">Async</a> v1.2.14</span></div><div class="trm-footer-item">博客已萌萌哒运行 <span id="since" class="trm-accent-color"></span> 天</div></footer><script>function show_date_time(){BirthDay=new Date("11/19/2019 17:00:00"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),msPerDay=864e5,day=Math.floor(timeold/msPerDay),since.innerHTML=day}show_date_time()</script></div></div></div></div></div><div class="trm-fixed-container" data-scroll data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="-10"><div class="trm-fixed-btn" data-title="阅读模式" onclick="switchReadMode()"><i class="iconfont fas fa-book-reader"></i></div></div></div></div></div></div><div id="trm-back-top" class="trm-back-top" data-title="回到顶部"><i class="iconfont fas fa-arrow-up"></i></div><div class="trm-search-popup"><div class="trm-search-header"><span class="trm-search-popup-btn-close"><i class="iconfont fas fa-times"></i></span></div><div class="form trm-search-form"><input class="trm-search-input" type="text" placeholder="搜索..."></div><div class="trm-search-result-container"></div></div><script src="https://unpkg.com/swup@2.0.19/dist/swup.min.js"></script><script src="https://unpkg.com/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script><script src="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script><script src="/js/plugins/typing.js?v=1.2.14"></script><script src="https://unpkg.com/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/plugins/local_search.js?v=1.2.14"></script><script src="//code.tidio.co/het7qhit6brc6kwukrbcbtltwr9xhcty.js" async></script><script id="async-script" src="/js/main.js?v=1.2.14"></script></body></html>